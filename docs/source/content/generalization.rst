.. _generalization-introduction:

Splam generalizes on non-human species
=========================================================================

Although Splam was trained on human datasets, we have shown that the model is able to generalize to other eukaryotic genomes, including plants. In our investigation, we tested the performance of Splam on the Chimpanzee (*Pan troglodytes*), Mouse (*Mus musculus*), and Thale cress, a flowering plant (*Arabidopsis thaliana*), genomes. We report that Splam outperforms SpliceAI in recall, precision, and accuracy, on every score threshold for every species. Additionally, we advise that users run Splam on a threshold of **0.1** for optimal performance. 

In the following sections, we will summarize our methods and key findings.

|

.. _generalization-data-curation:

Data curation 
+++++++++++++++++++++++++

For each species, we curated our positive and negative datasets similar to the Positive-MANE and Negative-Random strategies from :ref:`behind-the-scenes-splam`. The positive dataset was generated from the complete Refseq/TAIR annotation files downloaded from NCBI, where we extracted the introns from every transcript, filtered out poor annotations, and saved the remaining ~200k as splice junctions. The negative dataset was generated by randomly selecting variable-length canonical GT-AG pairs from the opposite strand of protein-coding genes. 

For both datasets, we randomly sampled 25,000 splice junctions and ran Splam and SpliceAI on them to compare results.


|

.. _generalization-key-findings:

Key findings
+++++++++++++++++++++++++

We find that Splam is able to quickly and accurately classify positive and negative samples, even in species as distant as plants (*Arabidopsis thaliana*). For the positive samples, Splam correctly classified the vast majority with a high score, whereas SpliceAI struggled more, particularly with *Arabidopsis* (:numref:`generalization-score-dist`). 

.. _generalization-score-dist:
.. figure::  ../_images/generalization_pos_score_dist.png
   :align:   center
   :scale:   8 %

   A comparison of the score distributions between Splam (green) and SpliceAI (orange) for the positive dataset. The top row represents donor site scores and the bottom row represents acceptor site scores. The darkened vertical line through the distribution represents the median value, while the two dotted vertical lines represent the first and third quartiles. Splam demonstrates the ability to correctly score positive samples highly, with a peak near 1.0 for all three species. SpliceAI's distributions are more spread out, especially for *Arabidopsis*, which exhibits an M-shaped distribution.

|

Combining this result with the negative data, we calculate summary statistics that help us gauge the performance of Splam at various thresholds. We observe that the recall/sensitivity, precision, and accuracy of Splam outperform SpliceAI at every score threshold for every species, visualized in :numref:`generalization-heatmap`.

.. _generalization-heatmap:
.. figure::  ../_images/generalization_performance_heatmap.png
   :align:   center
   :scale:   22 %

   A grid of heatmaps portraying the recall (top), precision (middle), and accuracy (bottom) of both models on the chimpanzee (left), mouse (middle), and *Arabidopsis* (right) genomes, across a variety of score thresholds (x-axis). For each heatmap, the top three rows (green) represent Splam, and the bottom three rows (orange) represent SpliceAI, where each is examined at the donor, acceptor, and splice junction levels. The performance metrics are reported as percentages on the heatmap. We observe that Splam exhibits high recall and accuracy whereas SpliceAI's swiftly declines with increasing score thresholds.

|

The results of this investigation suggest that Splam is able to generalize well to non-human species, including both animal and plant genomes.

Based on the thresholds we investigated, we advise users to run Splam on a threshold of **0.1** for optimal performance. 



|
|
|
|
|

.. image:: ../_images/jhu-logo-dark.png
   :alt: My Logo
   :class: logo, header-image only-light
   :align: center

.. image:: ../_images/jhu-logo-white.png
   :alt: My Logo
   :class: logo, header-image only-dark
   :align: center